"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[1629,2868,3068,9091,9758],{13068:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var a=n(81629),s=n(86087),i=n(27723),o=n(45111),l=n(82868),c=n(10790);const d=(0,s.memo)((()=>{const{documents:e,documentsLoaded:t,fetchData:d,deleteDocuments:r,editDocument:u}=(0,a.default)(),[m,g]=(0,s.useState)(""),[p,h]=(0,s.useState)({}),[f,_]=(0,s.useState)(!1),[b,x]=(0,s.useState)(!1),[w,C]=(0,s.useState)(""),[v,j]=(0,s.useState)([]),[y,k]=(0,s.useState)(!1),[z,L]=(0,s.useState)(null);(0,s.useEffect)((()=>{n.e(3757).then(n.bind(n,83757)).then((({default:e})=>{L((()=>e))}))}),[]),cmplz_settings.is_premium,(0,s.useEffect)((()=>{t||d()}),[t]);const N=async()=>{let t=e.filter((e=>v.includes(e.id)));k(!0);const n=async()=>{if(t.length>0){const e=t.shift(),a=e.download_url;C(!0);try{let s=new XMLHttpRequest;s.responseType="blob",s.open("get",a,!0),s.send(),s.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let n=window.URL.createObjectURL(this.response),a=window.document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",e.title),window.document.body.appendChild(a),a.click(),j(t),k(!1),setTimeout((function(){window.URL.revokeObjectURL(n)}),6e4)}},await n()}catch(e){console.error(e),C(!1)}}};await n(),C(!1)},D=e=>((e=e.filter((e=>e.title.toLowerCase().includes(m.toLowerCase())||e.service.toLowerCase().includes(m.toLowerCase())))).sort(((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)),e),S=[{name:(0,c.jsx)(l.default,{options:{true:""},indeterminate:f,value:b,onChange:t=>(t=>{if(t){x(!0);let t=p.currentPage?p.currentPage:1,n=D(e).slice(5*(t-1),5*t);j(n.map((e=>e.id)))}else x(!1),j([]);_(!1)})(t)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,i.__)("Document","complianz-gdpr"),selector:e=>e.title,sortable:!0,grow:6},{name:(0,i.__)("Region","complianz-gdpr"),selector:e=>(0,c.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}),sortable:!0,grow:2,right:!0},{name:(0,i.__)("Date","complianz-gdpr"),selector:e=>e.date,sortable:!0,grow:4,minWidth:"200px",right:!0}];let A=D(e),I=[];return A.forEach((t=>{let n={...t};n.selectControl=(0,c.jsx)(l.default,{value:v.includes(n.id),options:{true:""},onChange:t=>((t,n)=>{let a=t,s=[...v];a?s.includes(n)||(s.push(n),j(s)):(s=[...v.filter((e=>e!==n))],j(s));let i=p.currentPage?p.currentPage:1,o=D(e).slice(5*(i-1),5*i),l=!0,c=!1;o.forEach((e=>{s.includes(e.id)?c=!0:l=!1})),l?(x(!0),_(!1)):c?(x(!1),_(!0)):_(!1)})(t,n.id)}),I.push(n)})),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"cmplz-table-header",children:(0,c.jsx)("div",{className:"cmplz-table-header-controls",children:(0,c.jsx)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,i.__)("Search","complianz-gdpr"),value:m,onChange:e=>g(e.target.value)})})}),v.length>0&&(0,c.jsxs)("div",{className:"cmplz-selected-document",children:[v.length>1&&(0,i.__)("%s items selected","complianz-gdpr").replace("%s",v.length),1===v.length&&(0,i.__)("1 item selected","complianz-gdpr"),(0,c.jsxs)("div",{className:"cmplz-selected-document-controls",children:[(0,c.jsx)("button",{disabled:w||v.length>1,className:"button button-default",onClick:e=>u(v[0]),children:(0,i.__)("Edit","complianz-gdpr")}),(0,c.jsxs)("button",{disabled:w,className:"button button-default cmplz-btn-reset",onClick:()=>N(),children:[(0,i.__)("Download Processing Agreement","complianz-gdpr"),y&&(0,c.jsx)(o.default,{name:"loading",color:"grey"})]}),(0,c.jsx)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{j([]),await r(e)})(v),children:(0,i.__)("Delete","complianz-gdpr")})]})]}),z&&(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(z,{columns:S,data:I,dense:!0,pagination:!0,noDataComponent:(0,c.jsx)("div",{className:"cmplz-no-documents",children:(0,i.__)("No documents","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:5,onChangePage:e=>{h({...p,currentPage:e})},paginationState:p})})]})}))},79758:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var a=n(86087),s=n(9588),i=n(4219),o=n(52043),l=n(56427),c=n(99091),d=n(32828),r=n(10790);const u=(0,a.memo)((({type:e="action",style:t="tertiary",label:n,onClick:u,href:m="",target:g="",disabled:p,action:h,field:f,children:_})=>{if(!n&&!_)return null;const b=(f&&f.button_text?f.button_text:n)||_,{fetchFieldsData:x,showSavedSettingsNotice:w}=(0,i.default)(),{setInitialLoadCompleted:C,setProgress:v}=(0,c.UseCookieScanData)(),{setProgressLoaded:j}=(0,d.default)(),{selectedSubMenuItem:y}=(0,o.default)(),[k,z]=(0,a.useState)(!1),L=`button cmplz-button button--${t} button-${e}`,N=async e=>{await s.doAction(f.action,{}).then((e=>{e.success&&(x(y),"reset_settings"===e.id&&(C(!1),v(0),j(!1)),w(e.message))}))},D=f&&f.warn?f.warn:"";return"action"===e?(0,r.jsxs)(r.Fragment,{children:[l.__experimentalConfirmDialog&&(0,r.jsx)(l.__experimentalConfirmDialog,{isOpen:k,onConfirm:async()=>{z(!1),await N()},onCancel:()=>{z(!1)},children:D}),(0,r.jsx)("button",{className:L,onClick:async t=>{if("action"!==e||!u)return"action"===e&&h?l.__experimentalConfirmDialog?void(f&&f.warn?z(!0):await N()):void await N():void(window.location.href=f.url);u(t)},disabled:p,children:b})]}):"link"===e?(0,r.jsx)("a",{className:L,href:m,target:g,children:b}):void 0}))},81629:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var a=n(81621),s=n(16535),i=n(9588),o=n(73710);const l=(0,a.vt)(((e,t)=>({documentsLoaded:!1,region:"",fileName:"",serviceName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:"",serviceName:""})},editDocument:async t=>{e({updating:!0}),await i.doAction("load_processing_agreement",{id:t}).then((t=>{e({fields:t.fields,region:t.region,serviceName:t.serviceName,updating:!1,fileName:t.file_name})})).catch((e=>{console.error(e)})),e({editDocumentId:t})},setRegion:t=>{e({region:t})},setServiceName:t=>{e({serviceName:t})},updateField:(n,a)=>{let i=!1,l=!1;e((0,s.Ay)((e=>{e.fields.forEach((function(e,t){e.id===n&&(l=t,i=!0)})),!1!==l&&(e.fields[l].value=a)})));let c=(0,o.updateFieldsListWithConditions)(t().fields);e({fields:c})},save:async(n,a)=>{e({updating:!0});let s=t().editDocumentId;await i.doAction("save_processing_agreement",{fields:t().fields,region:n,serviceName:a,post_id:s}).then((t=>(e({updating:!1}),t))).catch((e=>{console.error(e)})),t().fetchData()},deleteDocuments:async n=>{let a=t().documents.filter((e=>n.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!n.includes(e.id)))})));let s={};s.documents=a,await i.doAction("delete_processing_agreement",s).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:n,regions:a}=await i.doAction("get_processing_agreements",{}).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({documentsLoaded:!0,documents:n,regions:a,fetching:!1})))},fetchFields:async t=>{let n={region:t};e({loadingFields:!0});const{fields:a}=await i.doAction("get_processing_agreement_fields",n).then((e=>e)).catch((e=>{console.error(e)}));let s=(0,o.updateFieldsListWithConditions)(a);e((e=>({fields:s,loadingFields:!1})))}})))},82868:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var a=n(92731),s=n(27723),i=n(45111),o=n(86087),l=n(79758),c=n(10790);const d=(0,o.memo)((({indeterminate:e,label:t,value:n,id:d,onChange:r,required:u,disabled:m,options:g={}})=>{const[p,h]=(0,o.useState)(!1),[f,_]=(0,o.useState)(!1);let b=n;Array.isArray(b)||(b=""===b?[]:[b]),(0,o.useEffect)((()=>{let e=1===Object.keys(g).length&&"true"===Object.keys(g)[0];h(e)}),[]),e&&(n=!0);const x=b;let w=!1;Object.keys(g).length>10&&(w=!0);const C=e=>p?n:x.includes(""+e)||x.includes(parseInt(e)),v=()=>{_(!f)};let j=m&&!Array.isArray(m);return 0===Object.keys(g).length?(0,c.jsx)(c.Fragment,{children:(0,s.__)("No options found","complianz-gdpr")}):(0,c.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(g).map((([s,o],l)=>(0,c.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!f&&l>9?" cmplz-hidden":""),children:[(0,c.jsx)(a.bL,{className:"cmplz-checkbox-group__checkbox",id:d+"_"+s,checked:C(s),"aria-label":t,disabled:j||Array.isArray(m)&&m.includes(s),required:u,onCheckedChange:e=>((e,t)=>{if(p)r(!n);else{const e=x.includes(""+t)||x.includes(parseInt(t))?x.filter((e=>e!==""+t&&e!==parseInt(t))):[...x,t];r(e)}})(0,s),children:(0,c.jsx)(a.C1,{className:"cmplz-checkbox-group__indicator",children:(0,c.jsx)(i.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,c.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:d+"_"+s,children:o})]},s))),!f&&w&&(0,c.jsx)(l.default,{onClick:()=>v(),children:(0,s.__)("Show more","complianz-gdpr")}),f&&w&&(0,c.jsx)(l.default,{onClick:()=>v(),children:(0,s.__)("Show less","complianz-gdpr")})]})}))},99091:(e,t,n)=>{n.r(t),n.d(t,{UseCookieScanData:()=>i});var a=n(81621),s=n(9588);const i=(0,a.vt)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),s.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))}}]);