"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[2868,5207,8550,9091,9758],{5207:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var n=a(81621),s=a(16535),i=a(9588),o=a(73710);const l=(0,n.vt)(((e,t)=>({documentsLoaded:!1,savedDocument:{},conclusions:[],region:"",fileName:"",fetching:!1,updating:!1,loadingFields:!1,documents:[],regions:[],fields:[],editDocumentId:!1,resetEditDocumentId:t=>{e({editDocumentId:!1,region:""})},editDocument:async t=>{e({updating:!0}),await i.doAction("load_databreach_report",{id:t}).then((t=>{e({fields:t.fields,region:t.region,updating:!1,fileName:t.file_name})})).catch((e=>{console.error(e)})),e({editDocumentId:t})},setRegion:t=>{e({region:t})},updateField:(a,n)=>{let i=!1,l=!1;e((0,s.Ay)((e=>{e.fields.forEach((function(e,t){e.id===a&&(l=t,i=!0)})),!1!==l&&(e.fields[l].value=n)})));let d=(0,o.updateFieldsListWithConditions)(t().fields);e({fields:d})},save:async a=>{e({updating:!0});let n=t().editDocumentId,s=0;await i.doAction("save_databreach_report",{fields:t().fields,region:a,post_id:n}).then((t=>(s=t.post_id,e({updating:!1,conclusions:t.conclusions}),t))).catch((e=>{console.error(e)})),await t().fetchData();let o=t().documents.filter((e=>e.id===s));o.length>0&&e({savedDocument:o[0]})},deleteDocuments:async a=>{let n=t().documents.filter((e=>a.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!a.includes(e.id)))})));let s={};s.documents=n,await i.doAction("delete_databreach_report",s).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:a,regions:n}=await i.doAction("get_databreach_reports",{}).then((e=>e)).catch((e=>{console.error(e)}));e((e=>({documentsLoaded:!0,documents:a,regions:n,fetching:!1})))},fetchFields:async t=>{let a={region:t};e({loadingFields:!0});const{fields:n}=await i.doAction("get_databreach_report_fields",a).then((e=>e)).catch((e=>{console.error(e)}));let s=(0,o.updateFieldsListWithConditions)(n);e((e=>({fields:s,loadingFields:!1})))}})))},28550:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var n=a(5207),s=a(86087),i=a(27723),o=a(45111),l=a(82868),d=a(10790);const c=(0,s.memo)((()=>{const{documents:e,documentsLoaded:t,fetchData:c,deleteDocuments:r,editDocument:u}=(0,n.default)(),[m,g]=(0,s.useState)(""),[p]=(0,s.useState)(""),[h,f]=(0,s.useState)(""),[b,_]=(0,s.useState)([]),[x,w]=(0,s.useState)(!1),[C,j]=(0,s.useState)({}),[y,k]=(0,s.useState)(!1),[z,v]=(0,s.useState)(!1),[L,D]=(0,s.useState)(null);(0,s.useEffect)((()=>{a.e(3757).then(a.bind(a,83757)).then((({default:e})=>{D((()=>e))}))}),[]),(0,s.useEffect)((()=>{t||c()}),[t]);const S=async()=>{let t=e.filter((e=>b.includes(e.id)));w(!0),f(!0);const a=async()=>{if(t.length>0){const e=t.shift(),n=e.download_url;try{let s=new XMLHttpRequest;s.responseType="blob",s.open("get",n,!0),s.send(),s.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let a=window.URL.createObjectURL(this.response),n=window.document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",e.title),window.document.body.appendChild(n),n.click(),_(t),w(!1),f(!1),setTimeout((function(){window.URL.revokeObjectURL(a)}),6e4)}},await a()}catch(e){console.error(e),f(!1)}}};await a()},N=e=>{let t=[...e];return""!==p&&(t=t.filter((e=>e.region===p))),t.sort(((e,t)=>e.title<t.title?-1:e.title>t.title?1:0)),t.filter((e=>e.title.toLowerCase().includes(m.toLowerCase()))),t},A=[{name:(0,d.jsx)(l.default,{options:{true:""},indeterminate:y,value:z,onChange:t=>(t=>{if(t){v(!0);let t=C.currentPage?C.currentPage:1,a=N(e).slice(5*(t-1),5*t);_(a.map((e=>e.id)))}else v(!1),_([]);k(!1)})(t)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,i.__)("Document","complianz-gdpr"),selector:e=>e.title,sortable:!0,grow:6},{name:(0,i.__)("Region","complianz-gdpr"),selector:e=>(0,d.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}),sortable:!0,grow:2,right:!0},{name:(0,i.__)("Date","complianz-gdpr"),selector:e=>e.date,sortable:!0,grow:4,right:!0,minWidth:"200px"}];let I=N(e),P=[];I.forEach((t=>{let a={...t};a.selectControl=(0,d.jsx)(l.default,{value:b.includes(a.id),options:{true:""},onChange:t=>((t,a)=>{let n=t,s=[...b];n?s.includes(a)||(s.push(a),_(s)):(s=[...b.filter((e=>e!==a))],_(s));let i=C.currentPage?C.currentPage:1,o=N(e).slice(5*(i-1),5*i),l=!0,d=!1;o.forEach((e=>{s.includes(e.id)?d=!0:l=!1})),l?(v(!0),k(!1)):d?(v(!1),k(!0)):k(!1)})(t,a.id)}),P.push(a)}));let F=b.length>1;return F||1!==b.length||(F=""!==e.filter((e=>b.includes(e.id)))[0].download_url),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"cmplz-table-header",children:(0,d.jsx)("div",{className:"cmplz-table-header-controls",children:(0,d.jsx)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,i.__)("Search","complianz-gdpr"),value:m,onChange:e=>g(e.target.value)})})}),b.length>0&&(0,d.jsxs)("div",{className:"cmplz-selected-document",children:[b.length>1&&(0,i.__)("%s items selected","complianz-gdpr").replace("%s",b.length),1===b.length&&(0,i.__)("1 item selected","complianz-gdpr"),(0,d.jsxs)("div",{className:"cmplz-selected-document-controls",children:[(0,d.jsx)("button",{disabled:h||b.length>1,className:"button button-default",onClick:()=>u(b[0]),children:(0,i.__)("Edit","complianz-gdpr")}),F&&(0,d.jsxs)("button",{disabled:h,className:"button button-default cmplz-btn-reset",onClick:()=>S(),children:[(0,i.__)("Download Data Breach Report","complianz-gdpr"),x&&(0,d.jsx)(o.default,{name:"loading",color:"grey"})]}),!F&&(0,d.jsx)("button",{disabled:!0,className:"button button-default cmplz-btn-reset",onClick:()=>S(),children:(0,i.__)("Reporting not required","complianz-gdpr")}),(0,d.jsx)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{_([]),await r(e)})(b),children:(0,i.__)("Delete","complianz-gdpr")})]})]}),L&&(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(L,{columns:A,data:P,dense:!0,pagination:!0,paginationPerPage:5,onChangePage:e=>{j({...C,currentPage:e})},paginationState:C,noDataComponent:(0,d.jsx)("div",{className:"cmplz-no-documents",children:(0,i.__)("No documents","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}}})})]})}))},79758:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var n=a(86087),s=a(9588),i=a(4219),o=a(52043),l=a(56427),d=a(99091),c=a(32828),r=a(10790);const u=(0,n.memo)((({type:e="action",style:t="tertiary",label:a,onClick:u,href:m="",target:g="",disabled:p,action:h,field:f,children:b})=>{if(!a&&!b)return null;const _=(f&&f.button_text?f.button_text:a)||b,{fetchFieldsData:x,showSavedSettingsNotice:w}=(0,i.default)(),{setInitialLoadCompleted:C,setProgress:j}=(0,d.UseCookieScanData)(),{setProgressLoaded:y}=(0,c.default)(),{selectedSubMenuItem:k}=(0,o.default)(),[z,v]=(0,n.useState)(!1),L=`button cmplz-button button--${t} button-${e}`,D=async e=>{await s.doAction(f.action,{}).then((e=>{e.success&&(x(k),"reset_settings"===e.id&&(C(!1),j(0),y(!1)),w(e.message))}))},S=f&&f.warn?f.warn:"";return"action"===e?(0,r.jsxs)(r.Fragment,{children:[l.__experimentalConfirmDialog&&(0,r.jsx)(l.__experimentalConfirmDialog,{isOpen:z,onConfirm:async()=>{v(!1),await D()},onCancel:()=>{v(!1)},children:S}),(0,r.jsx)("button",{className:L,onClick:async t=>{if("action"!==e||!u)return"action"===e&&h?l.__experimentalConfirmDialog?void(f&&f.warn?v(!0):await D()):void await D():void(window.location.href=f.url);u(t)},disabled:p,children:_})]}):"link"===e?(0,r.jsx)("a",{className:L,href:m,target:g,children:_}):void 0}))},82868:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var n=a(92731),s=a(27723),i=a(45111),o=a(86087),l=a(79758),d=a(10790);const c=(0,o.memo)((({indeterminate:e,label:t,value:a,id:c,onChange:r,required:u,disabled:m,options:g={}})=>{const[p,h]=(0,o.useState)(!1),[f,b]=(0,o.useState)(!1);let _=a;Array.isArray(_)||(_=""===_?[]:[_]),(0,o.useEffect)((()=>{let e=1===Object.keys(g).length&&"true"===Object.keys(g)[0];h(e)}),[]),e&&(a=!0);const x=_;let w=!1;Object.keys(g).length>10&&(w=!0);const C=e=>p?a:x.includes(""+e)||x.includes(parseInt(e)),j=()=>{b(!f)};let y=m&&!Array.isArray(m);return 0===Object.keys(g).length?(0,d.jsx)(d.Fragment,{children:(0,s.__)("No options found","complianz-gdpr")}):(0,d.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(g).map((([s,o],l)=>(0,d.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!f&&l>9?" cmplz-hidden":""),children:[(0,d.jsx)(n.bL,{className:"cmplz-checkbox-group__checkbox",id:c+"_"+s,checked:C(s),"aria-label":t,disabled:y||Array.isArray(m)&&m.includes(s),required:u,onCheckedChange:e=>((e,t)=>{if(p)r(!a);else{const e=x.includes(""+t)||x.includes(parseInt(t))?x.filter((e=>e!==""+t&&e!==parseInt(t))):[...x,t];r(e)}})(0,s),children:(0,d.jsx)(n.C1,{className:"cmplz-checkbox-group__indicator",children:(0,d.jsx)(i.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,d.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:c+"_"+s,children:o})]},s))),!f&&w&&(0,d.jsx)(l.default,{onClick:()=>j(),children:(0,s.__)("Show more","complianz-gdpr")}),f&&w&&(0,d.jsx)(l.default,{onClick:()=>j(),children:(0,s.__)("Show less","complianz-gdpr")})]})}))},99091:(e,t,a)=>{a.r(t),a.d(t,{UseCookieScanData:()=>i});var n=a(81621),s=a(9588);const i=(0,n.vt)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),s.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))}}]);