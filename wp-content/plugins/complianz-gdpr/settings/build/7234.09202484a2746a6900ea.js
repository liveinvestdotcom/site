"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[2868,4098,7234,9091,9758],{54098:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var a=n(81621),o=n(9588);const s=(0,a.vt)(((e,t)=>({documentsLoaded:!1,fetching:!1,generating:!1,documents:[],downloadUrl:"",regions:[],fields:[],deleteDocuments:async n=>{let a=t().documents.filter((e=>n.includes(e.id)));e((e=>({documents:e.documents.filter((e=>!n.includes(e.id)))})));let s={};s.documents=a,await o.doAction("delete_proof_of_consent_documents",s).then((e=>e)).catch((e=>{console.error(e)}))},generateProofOfConsent:async()=>{e({generating:!0}),await o.doAction("generate_proof_of_consent",{}).then((e=>e)).catch((e=>{console.error(e)})),await t().fetchData(),e({generating:!1})},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});const{documents:n,regions:a,download_url:s}=await o.doAction("get_proof_of_consent_documents",{}).then((e=>e)).catch((e=>{console.error(e)}));e((e=>({documentsLoaded:!0,documents:n,regions:a,downloadUrl:s,fetching:!1})))}})))},79758:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var a=n(86087),o=n(9588),s=n(4219),l=n(52043),i=n(56427),c=n(99091),r=n(32828),d=n(10790);const u=(0,a.memo)((({type:e="action",style:t="tertiary",label:n,onClick:u,href:m="",target:g="",disabled:p,action:h,field:f,children:_})=>{if(!n&&!_)return null;const b=(f&&f.button_text?f.button_text:n)||_,{fetchFieldsData:w,showSavedSettingsNotice:x}=(0,s.default)(),{setInitialLoadCompleted:C,setProgress:k}=(0,c.UseCookieScanData)(),{setProgressLoaded:j}=(0,r.default)(),{selectedSubMenuItem:y}=(0,l.default)(),[z,L]=(0,a.useState)(!1),v=`button cmplz-button button--${t} button-${e}`,S=async e=>{await o.doAction(f.action,{}).then((e=>{e.success&&(w(y),"reset_settings"===e.id&&(C(!1),k(0),j(!1)),x(e.message))}))},D=f&&f.warn?f.warn:"";return"action"===e?(0,d.jsxs)(d.Fragment,{children:[i.__experimentalConfirmDialog&&(0,d.jsx)(i.__experimentalConfirmDialog,{isOpen:z,onConfirm:async()=>{L(!1),await S()},onCancel:()=>{L(!1)},children:D}),(0,d.jsx)("button",{className:v,onClick:async t=>{if("action"!==e||!u)return"action"===e&&h?i.__experimentalConfirmDialog?void(f&&f.warn?L(!0):await S()):void await S():void(window.location.href=f.url);u(t)},disabled:p,children:b})]}):"link"===e?(0,d.jsx)("a",{className:v,href:m,target:g,children:b}):void 0}))},82868:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var a=n(92731),o=n(27723),s=n(45111),l=n(86087),i=n(79758),c=n(10790);const r=(0,l.memo)((({indeterminate:e,label:t,value:n,id:r,onChange:d,required:u,disabled:m,options:g={}})=>{const[p,h]=(0,l.useState)(!1),[f,_]=(0,l.useState)(!1);let b=n;Array.isArray(b)||(b=""===b?[]:[b]),(0,l.useEffect)((()=>{let e=1===Object.keys(g).length&&"true"===Object.keys(g)[0];h(e)}),[]),e&&(n=!0);const w=b;let x=!1;Object.keys(g).length>10&&(x=!0);const C=e=>p?n:w.includes(""+e)||w.includes(parseInt(e)),k=()=>{_(!f)};let j=m&&!Array.isArray(m);return 0===Object.keys(g).length?(0,c.jsx)(c.Fragment,{children:(0,o.__)("No options found","complianz-gdpr")}):(0,c.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(g).map((([o,l],i)=>(0,c.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!f&&i>9?" cmplz-hidden":""),children:[(0,c.jsx)(a.bL,{className:"cmplz-checkbox-group__checkbox",id:r+"_"+o,checked:C(o),"aria-label":t,disabled:j||Array.isArray(m)&&m.includes(o),required:u,onCheckedChange:e=>((e,t)=>{if(p)d(!n);else{const e=w.includes(""+t)||w.includes(parseInt(t))?w.filter((e=>e!==""+t&&e!==parseInt(t))):[...w,t];d(e)}})(0,o),children:(0,c.jsx)(a.C1,{className:"cmplz-checkbox-group__indicator",children:(0,c.jsx)(s.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,c.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:r+"_"+o,children:l})]},o))),!f&&x&&(0,c.jsx)(i.default,{onClick:()=>k(),children:(0,o.__)("Show more","complianz-gdpr")}),f&&x&&(0,c.jsx)(i.default,{onClick:()=>k(),children:(0,o.__)("Show less","complianz-gdpr")})]})}))},97234:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var a=n(86087),o=n(82868),s=n(27723),l=n(54098),i=n(10790);const c=(0,a.memo)((()=>{const{documents:e,downloadUrl:t,deleteDocuments:c,documentsLoaded:r,fetchData:d}=(0,l.default)(),[u,m]=(0,a.useState)(""),[g,p]=(0,a.useState)([]),[h,f]=(0,a.useState)({}),[_,b]=(0,a.useState)(!1),[w,x]=(0,a.useState)(!1),[C,k]=(0,a.useState)(null);(0,a.useEffect)((()=>{n.e(3757).then(n.bind(n,83757)).then((({default:e})=>{k((()=>e))}))}),[]),(0,a.useEffect)((()=>{r||d()}),[r]);const j=async()=>{let n=e.filter((e=>g.includes(e.id)));p([]);const a=async()=>{if(n.length>0){const e=n.shift(),o=t+"/"+e.file;m(!0);try{let t=new XMLHttpRequest;t.responseType="blob",t.open("get",o,!0),t.send(),t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let t=window.URL.createObjectURL(this.response),n=window.document.createElement("a");n.setAttribute("href",t),n.setAttribute("download",e.file),window.document.body.appendChild(n),n.click(),setTimeout((function(){window.URL.revokeObjectURL(t)}),6e4)}},await a()}catch(e){console.error(e),m(!1)}}};await a(),m(!1)},y=e=>(e.sort(((e,t)=>e.file<t.file?-1:e.file>t.file?1:0)),e),z=[{name:(0,i.jsx)(o.default,{options:{true:""},indeterminate:_,value:w,onChange:t=>(t=>{if(t){x(!0);let t=h.currentPage?h.currentPage:1,n=y(e).slice(10*(t-1),10*t);p(n.map((e=>e.id)))}else x(!1),p([]);b(!1)})(t)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,s.__)("Document","complianz-gdpr"),selector:e=>e.file,sortable:!0,grow:5},{name:(0,s.__)("Region","complianz-gdpr"),selector:e=>(0,i.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}),sortable:!0,grow:2,right:!0},{name:(0,s.__)("Consent","complianz-gdpr"),selector:e=>e.consent,sortable:!0,grow:2,right:!0},{name:(0,s.__)("Date","complianz-gdpr"),selector:e=>e.time,sortable:!0,grow:4,right:!0}];let L=[...e];L=y(L);let v=[];return L.forEach((t=>{let n={...t};n.selectControl=(0,i.jsx)(o.default,{value:g.includes(n.id),options:{true:""},onChange:t=>((t,n)=>{let a=[...g];t?a.includes(n)||(a.push(n),p(a)):(a=[...g.filter((e=>e!==n))],p(a));let o=h.currentPage?h.currentPage:1,s=y(e).slice(10*(o-1),10*o),l=!0,i=!1;s.forEach((e=>{a.includes(e.id)?i=!0:l=!1})),l?(x(!0),b(!1)):i?(x(!1),b(!0)):b(!1)})(!g.includes(n.id),n.id)}),v.push(n)})),(0,i.jsxs)(i.Fragment,{children:[g.length>0&&(0,i.jsxs)("div",{className:"cmplz-selected-document",children:[g.length>1&&(0,s.__)("%s items selected","complianz-gdpr").replace("%s",g.length),1===g.length&&(0,s.__)("1 item selected","complianz-gdpr"),(0,i.jsxs)("div",{className:"cmplz-selected-document-controls",children:[(0,i.jsx)("button",{disabled:u,className:"button button-default cmplz-btn-reset",onClick:()=>j(),children:(0,s.__)("Download Proof of Consent","complianz-gdpr")}),(0,i.jsx)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{p([]),await c(e)})(g),children:(0,s.__)("Delete","complianz-gdpr")})]})]}),C&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(C,{className:"cmplz-data-table",columns:z,data:v,dense:!0,pagination:!0,paginationPerPage:10,onChangePage:e=>{f({...h,currentPage:e})},paginationState:h,noDataComponent:(0,i.jsx)("div",{className:"cmplz-no-documents",children:(0,s.__)("No documents","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}}})})]})}))},99091:(e,t,n)=>{n.r(t),n.d(t,{UseCookieScanData:()=>s});var a=n(81621),o=n(9588);const s=(0,a.vt)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))}}]);