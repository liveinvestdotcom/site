"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[54,2868,3078,9091,9758],{40054:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var r=a(81621),o=a(9588);const n=(0,r.vt)(((e,t)=>({recordsLoaded:!1,fetching:!1,generating:!1,progress:!1,records:[],exportLink:"",downloadUrl:"",regions:[],fields:[],noData:!1,totalRecords:0,searchValue:"",setSearchValue:t=>e({searchValue:t}),paginationPerPage:10,pagination:{currentPage:1},setPagination:t=>e({pagination:t}),orderBy:"ID",setOrderBy:t=>e({orderBy:t}),order:"DESC",setOrder:t=>e({order:t}),deleteRecords:async a=>{let r=t().records.filter((e=>a.includes(e.id)));e((e=>({records:e.records.filter((e=>!a.includes(e.id)))})));let n={};n.records=r,await o.doAction("delete_records_of_consent",n).then((e=>e)).catch((e=>{console.error(e)}))},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});let a={};a.per_page=t().paginationPerPage,a.page=t().pagination.currentPage,a.order=t().order.toUpperCase(),a.orderBy=t().orderBy,a.search=t().searchValue;const{records:r,totalRecords:n,regions:s,download_url:i}=await o.doAction("get_records_of_consent",a).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({recordsLoaded:!0,records:r,regions:s,totalRecords:n,downloadUrl:i,fetching:!1})))},startExport:async()=>{e({generating:!0,progress:0,exportLink:""})},fetchExportRecordsOfConsentProgress:async(t,a,r)=>{(t=void 0!==t&&t)||e({generating:!0});let n={};n.startDate=a,n.endDate=r,n.statusOnly=t;const{progress:s,exportLink:i,noData:l}=await o.doAction("export_records_of_consent",n).then((e=>e)).catch((e=>{console.error(e)}));let c=!1;s<100&&(c=!0),e({progress:s,exportLink:i,generating:c,noData:l})}})))},79758:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var r=a(86087),o=a(9588),n=a(4219),s=a(52043),i=a(56427),l=a(99091),c=a(32828),d=a(10790);const p=(0,r.memo)((({type:e="action",style:t="tertiary",label:a,onClick:p,href:g="",target:m="",disabled:u,action:h,field:_,children:f})=>{if(!a&&!f)return null;const b=(_&&_.button_text?_.button_text:a)||f,{fetchFieldsData:x,showSavedSettingsNotice:w}=(0,n.default)(),{setInitialLoadCompleted:z,setProgress:C}=(0,l.UseCookieScanData)(),{setProgressLoaded:y}=(0,c.default)(),{selectedSubMenuItem:k}=(0,s.default)(),[j,v]=(0,r.useState)(!1),L=`button cmplz-button button--${t} button-${e}`,P=async e=>{await o.doAction(_.action,{}).then((e=>{e.success&&(x(k),"reset_settings"===e.id&&(z(!1),C(0),y(!1)),w(e.message))}))},S=_&&_.warn?_.warn:"";return"action"===e?(0,d.jsxs)(d.Fragment,{children:[i.__experimentalConfirmDialog&&(0,d.jsx)(i.__experimentalConfirmDialog,{isOpen:j,onConfirm:async()=>{v(!1),await P()},onCancel:()=>{v(!1)},children:S}),(0,d.jsx)("button",{className:L,onClick:async t=>{if("action"!==e||!p)return"action"===e&&h?i.__experimentalConfirmDialog?void(_&&_.warn?v(!0):await P()):void await P():void(window.location.href=_.url);p(t)},disabled:u,children:b})]}):"link"===e?(0,d.jsx)("a",{className:L,href:g,target:m,children:b}):void 0}))},82868:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var r=a(92731),o=a(27723),n=a(45111),s=a(86087),i=a(79758),l=a(10790);const c=(0,s.memo)((({indeterminate:e,label:t,value:a,id:c,onChange:d,required:p,disabled:g,options:m={}})=>{const[u,h]=(0,s.useState)(!1),[_,f]=(0,s.useState)(!1);let b=a;Array.isArray(b)||(b=""===b?[]:[b]),(0,s.useEffect)((()=>{let e=1===Object.keys(m).length&&"true"===Object.keys(m)[0];h(e)}),[]),e&&(a=!0);const x=b;let w=!1;Object.keys(m).length>10&&(w=!0);const z=e=>u?a:x.includes(""+e)||x.includes(parseInt(e)),C=()=>{f(!_)};let y=g&&!Array.isArray(g);return 0===Object.keys(m).length?(0,l.jsx)(l.Fragment,{children:(0,o.__)("No options found","complianz-gdpr")}):(0,l.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(m).map((([o,s],i)=>(0,l.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!_&&i>9?" cmplz-hidden":""),children:[(0,l.jsx)(r.bL,{className:"cmplz-checkbox-group__checkbox",id:c+"_"+o,checked:z(o),"aria-label":t,disabled:y||Array.isArray(g)&&g.includes(o),required:p,onCheckedChange:e=>((e,t)=>{if(u)d(!a);else{const e=x.includes(""+t)||x.includes(parseInt(t))?x.filter((e=>e!==""+t&&e!==parseInt(t))):[...x,t];d(e)}})(0,o),children:(0,l.jsx)(r.C1,{className:"cmplz-checkbox-group__indicator",children:(0,l.jsx)(n.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,l.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:c+"_"+o,children:s})]},o))),!_&&w&&(0,l.jsx)(i.default,{onClick:()=>C(),children:(0,o.__)("Show more","complianz-gdpr")}),_&&w&&(0,l.jsx)(i.default,{onClick:()=>C(),children:(0,o.__)("Show less","complianz-gdpr")})]})}))},93078:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var r=a(86087),o=a(27723),n=a(40054),s=a(82868),i=a(10790);const l=(0,r.memo)((()=>{const[e,t]=(0,r.useState)(!1),[l,c]=(0,r.useState)(!1),[d,p]=(0,r.useState)(null),{pagination:g,setPagination:m,paginationPerPage:u,orderBy:h,setOrderBy:_,totalRecords:f,order:b,setOrder:x,searchValue:w,setSearchValue:z,records:C,downloadUrl:y,deleteRecords:k,recordsLoaded:j,fetchData:v}=(0,n.default)(),[L,P]=(0,r.useState)(""),[S,N]=(0,r.useState)([]),D=!cmplz_settings.is_premium,[O,R]=(0,r.useState)(null);(0,r.useEffect)((()=>{a.e(3757).then(a.bind(a,83757)).then((({default:e})=>{R((()=>e))}))}),[]),(0,r.useEffect)((()=>{!j&&cmplz_settings.is_premium&&v()}),[j]);const I=async()=>{let e=C.filter((e=>S.includes(e.id)&&""!==e.poc_url));N([]);const t=async()=>{if(e.length>0){const a=e.shift(),r=y+"/"+a.poc_url;P(!0);try{let e=new XMLHttpRequest;e.responseType="blob",e.open("get",r,!0),e.send(),e.onreadystatechange=function(){if(4===this.readyState&&200===this.status){let e=window.URL.createObjectURL(this.response),t=window.document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",a.filename),window.document.body.appendChild(t),t.click(),setTimeout((function(){window.URL.revokeObjectURL(e)}),6e4)}},await t()}catch(e){console.error(e),P(!1)}}};await t(),P(!1)},A=((0,o.__)("Opt-in","complianz-gdpr"),(0,o.__)("Opt-out","complianz-gdpr"),(0,o.__)("Other","complianz-gdpr"),e=>(e=e.sort(((e,t)=>e.file<t.file?-1:e.file>t.file?1:0))).filter((e=>e.ip.toLowerCase().includes(w.toLowerCase())||e.services.toLowerCase().includes(w.toLowerCase())||e.id.toLowerCase().includes(w.toLowerCase())))),U=[{name:(0,i.jsx)(s.default,{options:{true:""},indeterminate:e,value:l,onChange:e=>(e=>{if(e){c(!0);let e=g.currentPage?g.currentPage:1,t=A(C).slice((e-1)*u,e*u);N(t.map((e=>e.id)))}else c(!1),N([]);t(!1)})(e)}),selector:e=>e.selectControl,grow:1,minWidth:"50px"},{name:(0,o.__)("User ID","complianz-gdpr"),selector:e=>e.id,sortable:!0,grow:3},{name:(0,o.__)("IP Address","complianz-gdpr"),selector:e=>e.ip,sortable:!0,grow:4},{name:(0,o.__)("Region","complianz-gdpr"),selector:e=>""!==e.region?(0,i.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}):(0,o.__)("Other","complianz-gdpr"),sortable:!0,grow:2},{name:(0,o.__)("Services","complianz-gdpr"),selector:e=>e.services,sortable:!0,grow:5},{name:(0,o.__)("Categories","complianz-gdpr"),selector:e=>(e=>{let t={do_not_track:(0,o.__)("DNT/GPC","complianz-gdpr"),no_choice:(0,o.__)("No Choice","complianz-gdpr"),no_warning:(0,o.__)("No Warning","complianz-gdpr"),functional:(0,o.__)("Functional","complianz-gdpr"),preferences:(0,o.__)("Preferences","complianz-gdpr"),statistics:(0,o.__)("Statistics","complianz-gdpr"),marketing:(0,o.__)("Marketing","complianz-gdpr")},a=[];return Object.keys(t).forEach((r=>{1===parseInt(e[r])&&a.push(t[r])})),a.join(", ")})(e),sortable:!0,grow:7},{name:(0,o.__)("Date","complianz-gdpr"),selector:e=>e.time,sortable:!0,grow:4,minWidth:"200px",right:!0}];let E=[...C];E=A(E);let T=[];return E.forEach((e=>{let a={...e};a.selectControl=(0,i.jsx)(s.default,{value:S.includes(a.id),options:{true:""},onChange:e=>((e,a)=>{let r=[...S];e?r.includes(a)||(r.push(a),N(r)):(r=[...S.filter((e=>e!==a))],N(r));let o=g.currentPage?g.currentPage:1,n=A(C).slice((o-1)*u,o*u),s=!0,i=!1;n.forEach((e=>{r.includes(e.id)?i=!0:s=!1})),s?(c(!0),t(!1)):i?(c(!1),t(!0)):t(!1)})(e,a.id)}),T.push(a)})),(0,i.jsxs)(i.Fragment,{children:[D&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"cmplz-settings-overlay",children:(0,i.jsx)("div",{className:"cmplz-settings-overlay-message"})})}),(0,i.jsx)("div",{className:"cmplz-table-header",children:(0,i.jsx)("div",{className:"cmplz-table-header-controls",children:(0,i.jsx)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,o.__)("Search","complianz-gdpr"),value:w,onChange:e=>(e=>{clearTimeout(d),z(e);const t=setTimeout((()=>{v(u,1,h,b)}),500);p(t)})(e.target.value)})})}),S.length>0&&(0,i.jsxs)("div",{className:"cmplz-selected-document",children:[S.length>1&&(0,o.__)("%s items selected","complianz-gdpr").replace("%s",S.length),1===S.length&&(0,o.__)("1 item selected","complianz-gdpr"),(0,i.jsxs)("div",{className:"cmplz-selected-document-controls",children:[C.filter((e=>S.includes(e.id)&&""!==e.poc_url)).length>0&&(0,i.jsx)("button",{disabled:L,className:"button button-default cmplz-btn-reset",onClick:()=>I(),children:(0,o.__)("Download Proof of Consent","complianz-gdpr")}),(0,i.jsx)("button",{className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{N([]),await k(e)})(S),children:(0,o.__)("Delete","complianz-gdpr")})]})]}),!D&&O&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(O,{columns:U,data:T,dense:!0,pagination:!0,paginationTotalRows:f,paginationServer:!0,noDataComponent:(0,i.jsx)("div",{className:"cmplz-no-documents",children:(0,o.__)("No records","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:u,onChangePage:e=>{m({...g,currentPage:e}),v()},paginationState:g,sortServer:!0,onSort:async(e,t)=>{_(e.orderId),x(t),v()}})})]})}))},99091:(e,t,a)=>{a.r(t),a.d(t,{UseCookieScanData:()=>n});var r=a(81621),o=a(9588);const n=(0,r.vt)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),o.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))}}]);