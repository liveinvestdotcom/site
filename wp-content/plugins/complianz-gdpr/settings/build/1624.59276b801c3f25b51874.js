"use strict";(globalThis.webpackChunkcomplianz_gdpr=globalThis.webpackChunkcomplianz_gdpr||[]).push([[622,1624,2868,9091,9758],{61624:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var r=a(86087),s=a(27723),o=a(90622),n=a(82868),l=a(10790);const c=(0,r.memo)((()=>{const[e,t]=(0,r.useState)(!1),[c,i]=(0,r.useState)(null),{records:d,searchValue:p,setSearchValue:g,deleteRecords:u,recordsLoaded:m,fetchData:h,status:_,setStatus:f,resolveRecords:x,totalRecords:b,fetching:v,paginationPerPage:y,pagination:z,setPagination:C,orderBy:j,setOrderBy:k,order:P,setOrder:D,selectedRecords:w,setSelectedRecords:I,setIndeterminate:S,indeterminate:L}=(0,o.default)(),[R,N]=(0,r.useState)(null);(0,r.useEffect)((()=>{a.e(3757).then(a.bind(a,83757)).then((({default:e})=>{N((()=>e))}))}),[]),(0,r.useEffect)((()=>{m||h(y,1,j,P)}),[m]);const O=[{name:(0,l.jsx)(n.default,{options:{true:""},indeterminate:L,value:e,onChange:e=>(e=>{if(e){t(!0);let e=z.currentPage?z.currentPage:1,a=d.slice((e-1)*y,e*y);I(a.map((e=>e.ID)))}else t(!1),I([]);S(!1)})(e)}),selector:e=>e.selectControl,orderId:"select",grow:1},{name:(0,s.__)("Email","complianz-gdpr"),selector:e=>e.email,sortable:!0,orderId:"email",grow:3},{name:(0,s.__)("Status","complianz-gdpr"),selector:e=>1==e.resolved?(0,s.__)("Resolved","complianz-gdpr"):(0,s.__)("Open","complianz-gdpr"),sortable:!0,orderId:"resolved",grow:1},{name:(0,s.__)("Region","complianz-gdpr"),selector:e=>e.region?(0,l.jsx)("img",{alt:"region",width:"20px",height:"20px",src:cmplz_settings.plugin_url+"assets/images/"+e.region+".svg"}):"",sortable:!0,grow:1},{name:(0,s.__)("Date","complianz-gdpr"),selector:e=>e.request_date,sortable:!0,grow:3},{name:(0,s.__)("Data Request","complianz-gdpr"),selector:e=>e.type?(0,l.jsx)("a",{target:"_blank",rel:"noopener noreferrer",href:"https://complianz.io/"+e.type.slug,children:e.type.short}):"",sortable:!0,orderId:"resolved",right:!0,grow:3}];let A=[...d],B=[];return A.forEach((e=>{let a={...e};a.selectControl=(0,l.jsx)(n.default,{disabled:v,value:w.includes(a.ID),options:{true:""},onChange:e=>((e,a)=>{let r=[...w];e?r.includes(a)||(r.push(a),I(r)):(r=[...w.filter((e=>e!==a))],I(r));let s=z.currentPage?z.currentPage:1,o=d.slice((s-1)*y,s*y),n=!0,l=!1;o.forEach((e=>{r.includes(e.ID)?l=!0:n=!1})),n?(t(!0),S(!1)):l?(t(!1),S(!0)):S(!1)})(e,a.ID)}),B.push(a)})),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"cmplz-table-header",children:(0,l.jsxs)("div",{className:"cmplz-table-header-controls",children:[(0,l.jsxs)("select",{value:_,onChange:e=>(e=>{f(e),setTimeout((()=>{h(y,1,j,P)}),500)})(e.target.value),children:[(0,l.jsx)("option",{value:"all",children:(0,s.__)("All","complianz-gdpr")}),(0,l.jsx)("option",{value:"open",children:(0,s.__)("Open","complianz-gdpr")}),(0,l.jsx)("option",{value:"resolved",children:(0,s.__)("Resolved","complianz-gdpr")})]}),(0,l.jsx)("input",{className:"cmplz-datatable-search",type:"text",placeholder:(0,s.__)("Search","complianz-gdpr"),value:p,onChange:e=>(e=>{clearTimeout(c),g(e);const t=setTimeout((()=>{h(y,1,j,P)}),500);i(t)})(e.target.value)})]})}),w.length>0&&(0,l.jsxs)("div",{className:"cmplz-selected-document",children:[w.length>1&&(0,s.__)("%s items selected","complianz-gdpr").replace("%s",w.length),1===w.length&&(0,s.__)("1 item selected","complianz-gdpr"),(0,l.jsxs)("div",{className:"cmplz-selected-document-controls",children:[d.filter((e=>w.includes(e.ID)&&1!=e.resolved)).length>0&&(0,l.jsx)("button",{disabled:v,className:"button button-default",onClick:()=>x(w),children:(0,s.__)("Mark as resolved","complianz-gdpr")}),(0,l.jsx)("button",{disabled:v,className:"button button-default cmplz-reset-button",onClick:()=>(async e=>{I([]),await u(e)})(w),children:(0,s.__)("Delete","complianz-gdpr")})]})]}),R&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(R,{columns:O,data:B,dense:!0,pagination:!0,paginationServer:!0,noDataComponent:(0,l.jsx)("div",{className:"cmplz-no-documents",children:(0,s.__)("No records","complianz-gdpr")}),persistTableHead:!0,theme:"really-simple-plugins",customStyles:{headCells:{style:{paddingLeft:"0",paddingRight:"0"}},cells:{style:{paddingLeft:"0",paddingRight:"0"}}},paginationPerPage:y,onChangePage:e=>{C({...z,currentPage:e}),h()},paginationState:z,paginationTotalRows:b,onChangeRowsPerPage:async(e,t)=>{C({...z,currentPage:t}),h(e,t,j,P)},onSort:async(e,t)=>{k(e.orderId),D(t),h()},sortServer:!0})})]})}))},79758:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var r=a(86087),s=a(9588),o=a(4219),n=a(52043),l=a(56427),c=a(99091),i=a(32828),d=a(10790);const p=(0,r.memo)((({type:e="action",style:t="tertiary",label:a,onClick:p,href:g="",target:u="",disabled:m,action:h,field:_,children:f})=>{if(!a&&!f)return null;const x=(_&&_.button_text?_.button_text:a)||f,{fetchFieldsData:b,showSavedSettingsNotice:v}=(0,o.default)(),{setInitialLoadCompleted:y,setProgress:z}=(0,c.UseCookieScanData)(),{setProgressLoaded:C}=(0,i.default)(),{selectedSubMenuItem:j}=(0,n.default)(),[k,P]=(0,r.useState)(!1),D=`button cmplz-button button--${t} button-${e}`,w=async e=>{await s.doAction(_.action,{}).then((e=>{e.success&&(b(j),"reset_settings"===e.id&&(y(!1),z(0),C(!1)),v(e.message))}))},I=_&&_.warn?_.warn:"";return"action"===e?(0,d.jsxs)(d.Fragment,{children:[l.__experimentalConfirmDialog&&(0,d.jsx)(l.__experimentalConfirmDialog,{isOpen:k,onConfirm:async()=>{P(!1),await w()},onCancel:()=>{P(!1)},children:I}),(0,d.jsx)("button",{className:D,onClick:async t=>{if("action"!==e||!p)return"action"===e&&h?l.__experimentalConfirmDialog?void(_&&_.warn?P(!0):await w()):void await w():void(window.location.href=_.url);p(t)},disabled:m,children:x})]}):"link"===e?(0,d.jsx)("a",{className:D,href:g,target:u,children:x}):void 0}))},82868:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var r=a(92731),s=a(27723),o=a(45111),n=a(86087),l=a(79758),c=a(10790);const i=(0,n.memo)((({indeterminate:e,label:t,value:a,id:i,onChange:d,required:p,disabled:g,options:u={}})=>{const[m,h]=(0,n.useState)(!1),[_,f]=(0,n.useState)(!1);let x=a;Array.isArray(x)||(x=""===x?[]:[x]),(0,n.useEffect)((()=>{let e=1===Object.keys(u).length&&"true"===Object.keys(u)[0];h(e)}),[]),e&&(a=!0);const b=x;let v=!1;Object.keys(u).length>10&&(v=!0);const y=e=>m?a:b.includes(""+e)||b.includes(parseInt(e)),z=()=>{f(!_)};let C=g&&!Array.isArray(g);return 0===Object.keys(u).length?(0,c.jsx)(c.Fragment,{children:(0,s.__)("No options found","complianz-gdpr")}):(0,c.jsxs)("div",{className:"cmplz-checkbox-group",children:[Object.entries(u).map((([s,n],l)=>(0,c.jsxs)("div",{className:"cmplz-checkbox-group__item"+(!_&&l>9?" cmplz-hidden":""),children:[(0,c.jsx)(r.bL,{className:"cmplz-checkbox-group__checkbox",id:i+"_"+s,checked:y(s),"aria-label":t,disabled:C||Array.isArray(g)&&g.includes(s),required:p,onCheckedChange:e=>((e,t)=>{if(m)d(!a);else{const e=b.includes(""+t)||b.includes(parseInt(t))?b.filter((e=>e!==""+t&&e!==parseInt(t))):[...b,t];d(e)}})(0,s),children:(0,c.jsx)(r.C1,{className:"cmplz-checkbox-group__indicator",children:(0,c.jsx)(o.default,{name:e?"indeterminate":"check",size:14,color:"dark-blue"})})}),(0,c.jsx)("label",{className:"cmplz-checkbox-group__label",htmlFor:i+"_"+s,children:n})]},s))),!_&&v&&(0,c.jsx)(l.default,{onClick:()=>z(),children:(0,s.__)("Show more","complianz-gdpr")}),_&&v&&(0,c.jsx)(l.default,{onClick:()=>z(),children:(0,s.__)("Show less","complianz-gdpr")})]})}))},90622:(e,t,a)=>{a.r(t),a.d(t,{default:()=>n});var r=a(81621),s=a(9588),o=a(16535);a(86087);const n=(0,r.vt)(((e,t)=>({recordsLoaded:!1,searchValue:"",setSearchValue:t=>e({searchValue:t}),status:"open",setStatus:t=>e({status:t}),selectedRecords:[],setSelectedRecords:t=>e({selectedRecords:t}),fetching:!1,generating:!1,progress:!1,records:[],totalRecords:0,totalOpen:0,exportLink:"",noData:!1,indeterminate:!1,setIndeterminate:t=>e({indeterminate:t}),paginationPerPage:10,pagination:{currentPage:1},setPagination:t=>e({pagination:t}),orderBy:"ID",setOrderBy:t=>e({orderBy:t}),order:"DESC",setOrder:t=>e({order:t}),deleteRecords:async a=>{let r={};r.per_page=t().paginationPerPage,r.page=t().pagination.currentPage,r.order=t().order.toUpperCase(),r.orderBy=t().orderBy,r.search=t().searchValue,r.status=t().status;let o=t().records.filter((e=>a.includes(e.ID)));e((e=>({records:e.records.filter((e=>!a.includes(e.ID)))}))),r.records=o,await s.doAction("delete_datarequests",r).then((e=>e)).catch((e=>{console.error(e)})),await t().fetchData(),t().setSelectedRecords([]),t().setIndeterminate(!1)},resolveRecords:async a=>{let r={};r.per_page=t().paginationPerPage,r.page=t().pagination.currentPage,r.order=t().order.toUpperCase(),r.orderBy=t().orderBy,r.search=t().searchValue,r.status=t().status,e((0,o.Ay)((e=>{e.records.forEach((function(t,r){a.includes(t.ID)&&(e.records[r].resolved=!0)}))}))),r.records=t().records.filter((e=>a.includes(e.ID))),await s.doAction("resolve_datarequests",r).then((e=>e)).catch((e=>{console.error(e)})),await t().fetchData(),t().setSelectedRecords([]),t().setIndeterminate(!1)},fetchData:async()=>{if(t().fetching)return;e({fetching:!0});let a={};a.per_page=t().paginationPerPage,a.page=t().pagination.currentPage,a.order=t().order.toUpperCase(),a.orderBy=t().orderBy,a.search=t().searchValue,a.status=t().status;const{records:r,totalRecords:o,totalOpen:n}=await s.doAction("get_datarequests",a).then((e=>e)).catch((e=>{console.error(e)}));e((()=>({recordsLoaded:!0,records:r,totalRecords:o,totalOpen:n,fetching:!1})))},startExport:async()=>{e({generating:!0,progress:0,exportLink:""})},fetchExportDatarequestsProgress:async(t,a,r)=>{(t=void 0!==t&&t)||e({generating:!0});let o={};o.startDate=a,o.endDate=r,o.statusOnly=t;const{progress:n,exportLink:l,noData:c}=await s.doAction("export_datarequests",o).then((e=>e)).catch((e=>{console.error(e)}));let i=!1;n<100&&(i=!0),e({progress:n,exportLink:l,generating:i,noData:c})}})))},99091:(e,t,a)=>{a.r(t),a.d(t,{UseCookieScanData:()=>o});var r=a(81621),s=a(9588);const o=(0,r.vt)(((e,t)=>({initialLoadCompleted:!1,setInitialLoadCompleted:t=>e({initialLoadCompleted:t}),iframeLoaded:!1,loading:!1,nextPage:!1,progress:0,cookies:[],lastLoadedIframe:"",setIframeLoaded:t=>e({iframeLoaded:t}),setLastLoadedIframe:t=>e((e=>({lastLoadedIframe:t}))),setProgress:t=>e({progress:t}),fetchProgress:()=>(e({loading:!0}),s.doAction("get_scan_progress",{}).then((t=>(e({initialLoadCompleted:!0,loading:!1,nextPage:t.next_page,progress:t.progress,cookies:t.cookies}),t))))})))}}]);